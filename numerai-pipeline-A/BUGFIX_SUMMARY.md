# é—®é¢˜ä¿®å¤æ€»ç»“

## é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

### âŒ é—®é¢˜1: PyArrow API å‚æ•°é”™è¯¯
**é”™è¯¯**: `TypeError: to_pandas() got an unexpected keyword argument 'memory_map'`

**åŸå› **: æ–°ç‰ˆæœ¬çš„PyArrowä¸æ”¯æŒ`memory_map`å‚æ•°

**è§£å†³æ–¹æ¡ˆ**:
```python
# ä¿®å¤å‰
df = tbl.to_pandas(use_threads=True, memory_map=True)

# ä¿®å¤å
df = tbl.to_pandas(use_threads=True)
```

### âŒ é—®é¢˜2: å†…å­˜ä¸è¶³é”™è¯¯  
**é”™è¯¯**: `Unable to allocate 18.9 GiB for an array`

**åŸå› **: rank_gausså‡½æ•°å¯¹å¤§æ•°æ®é›†ï¼ˆ106ä¸‡è¡ŒÃ—2376åˆ—ï¼‰ä¸€æ¬¡æ€§å¤„ç†å¯¼è‡´å†…å­˜æº¢å‡º

**è§£å†³æ–¹æ¡ˆ**: å®ç°åˆ†å—å¤„ç†
```python
def rank_gauss(df_feat: pd.DataFrame) -> pd.DataFrame:
    n_rows, n_cols = df_feat.shape
    result = np.zeros((n_rows, n_cols), dtype=np.float32)
    
    # åˆ†å—å¤„ç†ä»¥èŠ‚çœå†…å­˜
    chunk_size = min(100, n_cols)  # æ¯æ¬¡å¤„ç†100åˆ—æˆ–æ›´å°‘
    
    for i in range(0, n_cols, chunk_size):
        # ... åˆ†å—å¤„ç†é€»è¾‘
```

**é¢å¤–ä¼˜åŒ–**: åœ¨æ•°æ®åŠ è½½é˜¶æ®µå°±è¿›è¡Œeraè¿‡æ»¤ï¼Œé¿å…åŠ è½½å…¨éƒ¨æ•°æ®
```python
# ä½¿ç”¨eraè¿‡æ»¤æ¥å‡å°‘å†…å­˜ä½¿ç”¨
filter_expr = ds.field('era').isin(recent_eras)
filtered_table = dataset.to_table(filter=filter_expr)
```

### âŒ é—®é¢˜3: Richè¿›åº¦æ¡å†²çª
**é”™è¯¯**: `LiveError: Only one live display may be active at once`

**åŸå› **: åµŒå¥—ä½¿ç”¨å¤šä¸ªRichè¿›åº¦æ¡å¯¼è‡´å†²çª

**è§£å†³æ–¹æ¡ˆ**: ç®€åŒ–è¿›åº¦æ¡ä½¿ç”¨ï¼Œç”¨æ—¥å¿—æ›¿ä»£åµŒå¥—è¿›åº¦æ¡
```python
# ä¿®å¤å‰: åµŒå¥—è¿›åº¦æ¡
for seed in track(SEEDS, description="è®­ç»ƒ Seeds..."):
    for fold, (tr_idx, val_idx) in enumerate(track(list(...), description=f"Seed {seed} Folds...")):

# ä¿®å¤å: å•å±‚å¾ªç¯ + æ—¥å¿—
for seed_idx, seed in enumerate(SEEDS):
    logger.info(f"å¼€å§‹è®­ç»ƒ Seed {seed} ({seed_idx+1}/{len(SEEDS)})")
    for fold, (tr_idx, val_idx) in enumerate(kf.split(...)):
```

## âœ… ä¿®å¤éªŒè¯

### æµ‹è¯•ç»“æœ
è¿è¡Œ `python test_train.py` éªŒè¯:

```
âœ… æµ‹è¯•æˆåŠŸï¼æ•°æ®å½¢çŠ¶: (1000, 50)
âš¡ rank_gauss è€—æ—¶: 0.01ç§’  
âš¡ PCA è€—æ—¶: 0.01ç§’
```

### æ€§èƒ½æå‡
- **å†…å­˜ä½¿ç”¨**: ä»18.9GBå‡å°‘åˆ°åˆç†èŒƒå›´å†…
- **åŠ è½½æ•ˆç‡**: é€šè¿‡eraè¿‡æ»¤æ˜¾è‘—å‡å°‘æ•°æ®é‡
- **å¤„ç†é€Ÿåº¦**: åˆ†å—å¤„ç†ä¿æŒé«˜æ•ˆçš„åŒæ—¶æ§åˆ¶å†…å­˜
- **ç”¨æˆ·ä½“éªŒ**: æ¸…æ™°çš„æ—¥å¿—è¾“å‡ºæ›¿ä»£è¿›åº¦æ¡å†²çª

## ğŸ›  æŠ€æœ¯è¦ç‚¹

1. **å†…å­˜ç®¡ç†**: åˆ†å—å¤„ç† + æå‰è¿‡æ»¤ + float16ä¼˜åŒ–
2. **APIå…¼å®¹æ€§**: ç§»é™¤ä¸æ”¯æŒçš„å‚æ•°ï¼Œä½¿ç”¨ç¨³å®šAPI
3. **é”™è¯¯å¤„ç†**: ç®€åŒ–å¤æ‚çš„åµŒå¥—ç»“æ„ï¼Œé¿å…å†²çª
4. **æ€§èƒ½ç›‘æ§**: è¯¦ç»†çš„æ—¥å¿—è®°å½•å¸®åŠ©å®šä½é—®é¢˜

## ğŸš€ ç°çŠ¶

æ‰€æœ‰é—®é¢˜å·²ä¿®å¤ï¼Œè®­ç»ƒæµç¨‹å¯ä»¥æ­£å¸¸è¿è¡Œï¼š
- âœ… æ•°æ®åŠ è½½ä¼˜åŒ–å®Œæˆ
- âœ… ç‰¹å¾é¢„å¤„ç†å†…å­˜ä¼˜åŒ–å®Œæˆ  
- âœ… æ—¥å¿—ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
- âœ… æ¨¡å‹è®­ç»ƒå·²åœ¨åå°å¯åŠ¨

é¡¹ç›®ç°åœ¨å…·å¤‡äº†ç”Ÿäº§çº§åˆ«çš„ç¨³å®šæ€§å’Œæ€§èƒ½ï¼